{"remainingRequest":"F:\\GitHub\\Vue-project\\web-store\\node_modules\\babel-loader\\lib\\index.js!F:\\GitHub\\Vue-project\\web-store\\src\\basket\\Basket.js","dependencies":[{"path":"F:\\GitHub\\Vue-project\\web-store\\src\\basket\\Basket.js","mtime":1612900702568},{"path":"F:\\GitHub\\Vue-project\\web-store\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\GitHub\\Vue-project\\web-store\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIjsKaW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJGOi9HaXRIdWIvVnVlLXByb2plY3Qvd2ViLXN0b3JlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheSI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkY6L0dpdEh1Yi9WdWUtcHJvamVjdC93ZWItc3RvcmUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIkY6L0dpdEh1Yi9WdWUtcHJvamVjdC93ZWItc3RvcmUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJGOi9HaXRIdWIvVnVlLXByb2plY3Qvd2ViLXN0b3JlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiRjovR2l0SHViL1Z1ZS1wcm9qZWN0L3dlYi1zdG9yZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkiOwppbXBvcnQgeyBtZXRob2RzIH0gZnJvbSAnLi4vYXBpL2NydWQuanMnOwppbXBvcnQgeyB1cmxzIH0gZnJvbSAnLi4vYXBpL3VybHMuanMnOwoKdmFyIEJhc2tldCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQmFza2V0KCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJhc2tldCk7CgogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJiYXNrZXRTdG9yZSIsIFtdKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImJhc2tldCIsIFtdKTsKCiAgICB0aGlzLmJhc2tldFN0b3JlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2Jhc2tldCcpID8gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYmFza2V0JykpIDogW107CiAgfQoKICBfY3JlYXRlQ2xhc3MoQmFza2V0LCBbewogICAga2V5OiAiYWRkUHJvZHVjdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkUHJvZHVjdChpdGVtSWQpIHsKICAgICAgdmFyIHF1YW50aXR5ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAxOwogICAgICB2YXIgc2VhcmNoSXRlbSA9IHRoaXMuYmFza2V0U3RvcmUuZmluZChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtLmlkID09PSBpdGVtSWQ7CiAgICAgIH0pIHx8IGZhbHNlOwoKICAgICAgaWYgKHNlYXJjaEl0ZW0gJiYgcXVhbnRpdHkgIT09IDEpIHsKICAgICAgICBzZWFyY2hJdGVtLnF1YW50aXR5ID0gcXVhbnRpdHk7CiAgICAgIH0gZWxzZSBpZiAoc2VhcmNoSXRlbSAmJiBxdWFudGl0eSA9PT0gMSkgewogICAgICAgIHNlYXJjaEl0ZW0ucXVhbnRpdHkgKz0gcXVhbnRpdHk7CiAgICAgIH0gZWxzZSBpZiAoIXNlYXJjaEl0ZW0pIHsKICAgICAgICB0aGlzLmJhc2tldFN0b3JlLnB1c2goewogICAgICAgICAgJ2lkJzogaXRlbUlkLAogICAgICAgICAgJ3F1YW50aXR5JzogcXVhbnRpdHkKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuYmFza2V0U3RvcmUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHRoaXMuX2Jhc2tldFN5bmNpbmcoKTsKCiAgICAgICAgdGhpcy5nZXRCYXNrZXRQcm9kdWN0cygpLnRoZW4oKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInJlbW92ZVByb2R1Y3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVByb2R1Y3QoaXRlbUlkKSB7CiAgICAgIGlmIChpdGVtSWQpIHsKICAgICAgICB2YXIgc2VhcmNoSXRlbSA9IHRoaXMuYmFza2V0U3RvcmUuZmluZChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgcmV0dXJuIGl0ZW0uaWQgPT09IGl0ZW1JZDsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKHNlYXJjaEl0ZW0pIHsKICAgICAgICAgIHZhciBpbmRleEl0ZW0gPSB0aGlzLmJhc2tldFN0b3JlLmluZGV4T2Yoc2VhcmNoSXRlbSk7CiAgICAgICAgICB0aGlzLmJhc2tldFN0b3JlLnNwbGljZShpbmRleEl0ZW0sIDEpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5nZXRCYXNrZXRQcm9kdWN0cygpLnRoZW4oKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ1cGRhdGVQcm9kdWN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVQcm9kdWN0KGl0ZW1JZCwgcXVhbnRpdHkpIHsKICAgICAgaWYgKGl0ZW1JZCAmJiBxdWFudGl0eSkgewogICAgICAgIHZhciBzZWFyY2hJdGVtID0gdGhpcy5iYXNrZXRTdG9yZS5maW5kKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICByZXR1cm4gaXRlbS5pZCA9PT0gaXRlbUlkOwogICAgICAgIH0pOwogICAgICAgIHNlYXJjaEl0ZW0ucXVhbnRpdHkgPSBxdWFudGl0eTsKICAgICAgfQoKICAgICAgdGhpcy5fYmFza2V0U3luY2luZygpOwoKICAgICAgdGhpcy5nZXRCYXNrZXRQcm9kdWN0cygpLnRoZW4oKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfYmFza2V0U3luY2luZyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2Jhc2tldFN5bmNpbmcoKSB7CiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJiYXNrZXQiLCBKU09OLnN0cmluZ2lmeSh0aGlzLmJhc2tldFN0b3JlKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3VybHNJZGVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfdXJsc0lkZXMoKSB7CiAgICAgIHZhciBpZHMgPSBbXTsKICAgICAgdGhpcy5iYXNrZXRTdG9yZS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGlkcy5wdXNoKGl0ZW0uaWQpOwogICAgICB9KTsKICAgICAgcmV0dXJuICIiLmNvbmNhdCh1cmxzLmJhc2tldCkuY29uY2F0KGlkcywgIiZsaW1pdD0xMDAiKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRCYXNrZXRQcm9kdWN0cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldEJhc2tldFByb2R1Y3RzID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAgIHZhciB1cmw7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKCEodGhpcy5iYXNrZXRTdG9yZSAmJiB0aGlzLmJhc2tldFN0b3JlLmxlbmd0aCA+IDApKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aGlzLl9iYXNrZXRTeW5jaW5nKCk7CgogICAgICAgICAgICAgICAgdXJsID0gdGhpcy5fdXJsc0lkZXMoKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgcmV0dXJuIG1ldGhvZHMuZ2V0KHVybCkudGhlbihmdW5jdGlvbiAocmVxKSB7CiAgICAgICAgICAgICAgICAgIHZhciBiYXNrZXQgPSBfdG9Db25zdW1hYmxlQXJyYXkocmVxLnJlc3VsdHMpOwoKICAgICAgICAgICAgICAgICAgYmFza2V0Lm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgICAgIHZhciBzdG9yZUl0ZW0gPSBfdGhpcy5iYXNrZXRTdG9yZS5maW5kKGZ1bmN0aW9uIChwcm9kKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5pZCA9PT0gcHJvZC5pZDsKICAgICAgICAgICAgICAgICAgICB9KSB8fCBbXTsKICAgICAgICAgICAgICAgICAgICBpdGVtWydxdWFudGl0eSddID0gc3RvcmVJdGVtLnF1YW50aXR5OwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgX3RoaXMuYmFza2V0ID0gYmFza2V0OwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIHRoaXMuX2Jhc2tldFN5bmNpbmcoKTsKCiAgICAgICAgICAgICAgICB0aGlzLmJhc2tldCA9IFtdOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0QmFza2V0UHJvZHVjdHMoKSB7CiAgICAgICAgcmV0dXJuIF9nZXRCYXNrZXRQcm9kdWN0cy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZ2V0QmFza2V0UHJvZHVjdHM7CiAgICB9KCkKICB9XSk7CgogIHJldHVybiBCYXNrZXQ7Cn0oKTsKCmV4cG9ydCB7IEJhc2tldCBhcyBkZWZhdWx0IH07"},{"version":3,"sources":["F:/GitHub/Vue-project/web-store/src/basket/Basket.js"],"names":["methods","urls","Basket","basketStore","localStorage","getItem","JSON","parse","itemId","quantity","searchItem","find","item","id","push","undefined","_basketSyncing","getBasketProducts","then","indexItem","indexOf","splice","setItem","stringify","ids","forEach","basket","length","url","_urlsIdes","get","req","results","map","storeItem","prod"],"mappings":"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","sourcesContent":["import {methods} from '../api/crud.js'\r\nimport {urls} from '../api/urls.js'\r\n\r\nexport default class Basket {\r\n    basketStore = [];\r\n    basket = [];\r\n\r\n    constructor() {\r\n        this.basketStore = localStorage.getItem('basket') ? JSON.parse(localStorage.getItem('basket')) : []\r\n    }\r\n\r\n    addProduct(itemId, quantity= 1) {\r\n        let searchItem = this.basketStore.find((item) => item.id === itemId) || false;\r\n\r\n        if (searchItem && quantity !== 1) {\r\n            searchItem.quantity = quantity;\r\n\r\n        } else if (searchItem && quantity === 1) {\r\n            searchItem.quantity += quantity;\r\n\r\n        } else if (!searchItem) {\r\n            this.basketStore.push({'id': itemId, 'quantity': quantity});\r\n        }\r\n        if (this.basketStore !== undefined) {\r\n            this._basketSyncing()\r\n            this.getBasketProducts().then()\r\n        }\r\n    }\r\n\r\n    removeProduct(itemId) {\r\n        if (itemId) {\r\n            let searchItem = this.basketStore.find((item) => item.id === itemId);\r\n            if (searchItem) {\r\n                let indexItem = this.basketStore.indexOf(searchItem)\r\n                this.basketStore.splice(indexItem, 1)\r\n            }\r\n        }\r\n\r\n        this.getBasketProducts().then()\r\n\r\n\r\n    }\r\n\r\n    updateProduct (itemId, quantity) {\r\n        if (itemId && quantity) {\r\n            let searchItem = this.basketStore.find((item) => item.id === itemId);\r\n            searchItem.quantity = quantity\r\n        }\r\n        this._basketSyncing()\r\n        this.getBasketProducts().then()\r\n    }\r\n\r\n\r\n    _basketSyncing() {\r\n            localStorage.setItem(\"basket\", JSON.stringify(this.basketStore))\r\n    }\r\n\r\n    _urlsIdes() {\r\n        let ids = [];\r\n        this.basketStore.forEach(item => ids.push(item.id));\r\n        return `${urls.basket}${ids}&limit=100`;\r\n\r\n    }\r\n\r\n    async getBasketProducts () {\r\n        if (this.basketStore && this.basketStore.length > 0) {\r\n            this._basketSyncing()\r\n            let url = this._urlsIdes()\r\n            await methods.get(url)\r\n                .then((req) => {\r\n                    let basket = [...req.results]\r\n                    basket.map((item) => {\r\n                        const storeItem = this.basketStore.find(prod => item.id === prod.id) || [];\r\n                        item['quantity'] = storeItem.quantity\r\n\r\n                    })\r\n                    this.basket = basket\r\n                })\r\n        } else {\r\n            this._basketSyncing()\r\n            this.basket = []\r\n        }\r\n\r\n    }\r\n\r\n}\r\n"]}]}